# AI 語音轉文字 & 自動字幕生成工具 v2.0
[![For Windows - Download exe](https://img.shields.io/badge/For%20Windows-Download%20exe-blue?style=for-the-badge&logo=windows)](https://github.com/suyanali/AI_TranslateSRT/releases/download/v1.0/Release_windows_v1.0.zip)    [![For Mac - Download Source Code](https://img.shields.io/badge/For%20Mac-Download%20Source%20Code-blue?style=for-the-badge&logo=apple)](https://github.com/suyanali/AI_TranslateSRT/archive/refs/heads/main.zip)

這是一個使用 Google Gemini API 的圖形化工具，可以將**影片或音訊**檔案（包含外語內容翻譯）自動轉錄成帶有時間軸的 SRT 字幕檔案。本工具整合了日誌記錄與 SRT轉錄(AI 摘要)功能，讓整個轉錄流程更加自動化且易於追蹤。所有功能都是跟 GEMINI CLI、google ai studio與chatgptt共同討論做出來的，有 bug 可以回報，但我可能修不好😅。 



## ✨ 功能特色

🎞️ **影音轉字幕**：支援所有 FFmpeg 可轉換的影音格式，自動生成 SRT。

🖥️ **圖形化介面**：無需複雜指令，操作全在視窗中完成。

🎯 **Prompt 動態調整**：可指定最終字幕語言、一行字數，並支援術語/專有名詞對照表（含性別欄位）。支援手動編輯、匯出/匯入，以及大量貼上 (Ctrl+V / Cmd+V)。

⚙️ **參數可調**：可自訂 API Key、Gemini 模型、音訊分段時長等。

📑 **SRT 轉錄摘要**：轉錄完成後，會自動生成摘要報告，快速掌握關鍵事件。

📜 **完整日誌**：自動記錄執行過程並即時顯示。

🔑 **僅支援 Google Gemini API**。

🔄 **恢復轉錄**：中途關閉或只需補跑部分字幕時，可選擇恢復模式，不必全部重跑。

⏩ **局部轉錄**：只針對指定時間段生成字幕。

📂 **僅合併字幕**：可將手動修改過的分段 SRT 再次合併。

---

## 🚀 開始使用
*  本工具提供兩種使用方式，請根據您的作業系統和需求選擇其中一種。
*  📌必要元件：
    *  ffmpeg(ffmpeg.exe或 PATH環境變數皆可)
    *  Google Gemini API Key（可輸入於程式或設於環境變數）

### 💻方式一：Windows 使用者 (快速開始)

此方式最為簡單，推薦給所有 Windows 使用者。

1.  到 [Releases 頁面](https://github.com/suyanali/AI_TranslateSRT/releases) 下載最新的 `Release_windows.zip` 壓縮檔。
2.  解壓縮至任意位置*
3.   ⚠️ **確認檔案完整 (非常重要！)**：需包含以下程式並確保兩者在同一資料夾
    *   1.  `AI_TranslateSRT.exe` (主程式)
        2.  `ffmpeg.exe` (音訊處理工具)
4.   直接雙擊 `AI_TranslateSRT.exe` 即可啟動程式。



### 方式二：從原始碼執行 (開發者 / Mac / Linux 使用者)

(我沒有mac跟linux，所以下面安裝指南是ai寫的)，需安裝 **Python 3.11** 與 **FFmpeg**：

#### 1. 環境設定

*   **安裝 Python 3**：請確保您的系統已安裝 Python 3.11 。您可以從 [Python 官網](https://www.python.org/downloads/) 下載。
*   **安裝 FFmpeg**：請確保您的系統已安裝 FFmpeg，並將其加入到系統的環境變數 (PATH) 中。
    *   **Mac 使用者**可透過 [Homebrew](https://brew.sh/) 輕鬆安裝： `brew install ffmpeg`
    *   **Linux 使用者**可透過包管理器安裝： `sudo apt update && sudo apt install ffmpeg`

#### 2. 下載原始碼

*   您可以 `git clone` 本專案，或從 GitHub 頁面點擊 `Code` -> `Download ZIP` 來下載原始碼。

#### 3. 安裝 Python 依賴套件

```bash
pip install -r requirements.txt
# 或單獨安裝
pip install google-genai
```

#### 4. 執行程式

在終端機中，繼續使用以下指令來啟動圖形化介面：(` transcribe_pro_gui_v2_84.py` 、`transcribe_pro_v5_branch_04_branch_70.py`請放置同一資料夾裡)

```bash
python transcribe_pro_gui_v2_84.py
```

---



## 📖 介面與操作流程  
![imgur](https://imgur.com/X9svBzP.png)




## **依照圖示數字順序操作**：  

1. 選擇來源的影音檔 
2.   進階設定中選擇要翻譯成的語言，根據要翻譯成的語言填寫一行平均字幕字數(例如 中文為16字元) 
3. 指定翻譯的名稱（例如角色名字、地名、專有名詞）
4.  填入 API Key 
5. 確認使用的gemini api model
6.  按下「開始轉錄」
7. 最後：SRT檢查、看日誌

### 🚀各項解釋：

1. **選擇來源檔案**  
   點擊 選擇檔案... 按鈕，選擇您想要轉錄的影片 (.mp4, .mkv等多種格式) 或音訊 (.mp3, .wav等多種格式) 檔案，只要ffmpeg能轉檔的都可以。

2. **設定轉錄與翻譯規則**  

   * **主要規則**：這裡包含了給 AI 的核心指令，可自定義，通常不需要修改。**注意：請勿刪除或修改大括號 {} 內的佔位符(如 `{max_chars} `、`{language}`、`{fifth_priority}`、`{sixth_priority}`、`{seventh_priority}`、`{final_instruction}` )，否則可能導致程式無法正常運作。**

   * **進階設定**：
     * **目標語言**：您希望字幕最終呈現的語言，例如「繁體中文」或「英文」。
     * **單行字數上限**：中文建議16字元、英文42字元。
     * **人名或術語對應表**：如果影片中有特定的專有名詞或人名，您可以在這裡設定對照表 (例如 Alex = 亞歷克斯 = 男)，AI 會優先使用您設定的翻譯。支援智慧大量貼入，有支援匯入以及匯出術語表。匯入僅支援utf-8編碼的.txt。  
      ![imgur](https://imgur.com/jo1e6iA.jpg)  
     
        `術語貼入後可以編輯，格式如圖，你可以打字成那樣後用txt匯入，或者複製後，到術語表那一片表格區域按貼上快捷鍵也會自動貼上(支援大量貼上)。`建議：分別把全名、姓、名，各自建檔。  
        ![imgur](https://imgur.com/9kPfp9k.jpg)  
        
        `匯入時可以選擇覆蓋或增量。`  
        ![imgur](https://imgur.com/XZCELmF.jpg)    
       * 可自行建立或由 AI 協助，例如perplexity.ai，prompt：「音樂劇「XXXXX」中所有角色、演員、專有名詞的`{原始語言}`名字及其常見`{目標語言}`名字翻譯與性別對照表。請用以下格式整理:  Alex = 亞歷克斯 = 男」

3. 參數說明

   *   **API Key**：您的 Google API 金鑰。如果留空，程式會嘗試從系統環境變數讀取。

   *   **模型名稱**：使用的 Gemini 模型，預設為 `models/gemini-2.5-pro`。可根據需求更換。**PS: 建議至少使用gemini-2.5-pro或gemini-2.5-flash模型。** 2.5-pro最好，其他低階模型品質差。  

   *   **分段時長 (秒)**：將大型影音檔切成小段落處理的時長，預設為 600 秒 (10分鐘)，設定太長會在後續語音轉文字時容易失敗，建議不要動。
   *   **暫存資料夾**：設定在處理過程中，臨時儲存音訊片段的資料夾路徑。默認在本程式所在資料夾生成一個temp資料夾。

---
**進階參數**：  (一般無須調整)

   *   **修正閾值**：觸發自動重試的品質標準，數字越小，標準越嚴格。
   *   **重疊容忍 (秒)**：允許相鄰字幕在時間上的重疊秒數，用於處理合唱或對話緊湊的情境。設為負數 (例如 -1) 可完全關閉重疊偵測。
   *    **結尾空白閥值**：偵測分割音檔在結尾是否出現長時間無字幕/靜音的異常，超過此秒數即判定為可疑截斷。設為 0 可停用此檢查。
   *    **連續空值終止閥值**：連續收到 API 空白回應(empty response)達到此次數，就自動中止任務。設為 0 可關閉此功能。
   *    **併發數**：同時處理的轉錄任務數量，數字越大速度越快，但會增加電腦負載與 API 壓力，預設1。
   *    **每分鐘請求數**：限制每分鐘對 API 的總請求次數，用來避免觸發限流，數字越小越安全但速度會變慢，可根據官方該model頻率限制做調整，預設為 3
   *    **匯出設定檔/匯入設定檔**：設定檔存檔後下次就不用重複填寫參數，裡面會寫入你填的api key注意不要隨意給他人喔。

---

4. **開始轉錄與查看日誌**：設定完成後，點擊 **開始轉錄** 按鈕。下方的「即時日誌」視窗會開始顯示詳細的執行過程(同時日誌也會自動存檔)。轉錄所需時間依檔案長度而定，請耐心等候。據筆者經驗2小時半至3小時影片，排除ffmpeg轉檔的部分，純粹srt這部份生成花費時間約37分~65分，因為中間也許會觸發重試機制(修正閾值)所花時間不一定。
*    **未完成的任務**: 當偵測到temp資料夾裡有與來源檔案一致分段時長的mp3或srt時會觸發，你可以選擇「恢復任務」或「重新開始」。
*    	**「恢復任務」**：只補上缺的區塊音檔跟補上缺的區塊字幕檔
*    	**「重新開始」**：先刪除與來源檔案一致分段時長的mp3與srt後再重新分割影音檔與重跑srt轉錄。
![imgur](https://imgur.com/Gk5bW3K.jpg)  
5. **「僅重新合併 SRT」模式**：只會合併與來源檔名一致分段時長的srt檔案。



## 📁 關於輸出檔案

轉錄成功後，所有相關檔案都會儲存在您**主程式所在的資料夾**下：

*   `[您的影片名稱].srt`：**最終的字幕成品！**
*   `[您的影片名稱]_日誌_[時間].txt`：本次執行的完整文字日誌。
*   `[您的影片名稱]_SRT轉錄情況_[時間].txt`：由 AI 分析日誌後生成的專注於srt生成情況的摘要報告。

### 📝【重要】關於最終字幕的品質檢查

雖然本程式內建了強大的自動校正機制，但 AI 的輸出仍可能存在瑕疵。為了確保最佳品質，**強烈建議**您在轉錄完成後，進行一個快速的檢查，同時也可以參考AI智慧摘要`[您的影片名稱]_SRT轉錄情況_[時間].txt`：

1. **先觀看SRT轉錄情況**：著重出現`重試`、`API回應空白`或`SRT截斷警告`的分段srt，重試是否成功？API回應空白是否連續出現，這之後是否那段字幕有成功生成？SRT截斷警告為當最後一句字幕離該音檔結束(默認10min)離超過默認的60秒(可到`結尾空白閥值`修改數值)就會在日誌提出警報，請事後看一下是正好沒對話還是ai沒有轉錄到。

2. **其他觀察要點**：有沒有出現大量亂碼或完全不相關的文字？ 有沒有沒有翻譯成目標語言的文字? 

   - 最終成品的`[您的影片名稱].srt`也建議到字幕軟體(例如subtitle edit)觀看，若有不正常的地方會上底色，可以輔助檢查。
   - 個人會直接播放來源影片搭配完整版字幕，每5分鐘前後快速跳躍看(例如3分鐘、8分鐘的位置)，主要是審核有沒有局部時間段沒有被語音轉文字。

3. 如果發現某個分段字幕內容有嚴重問題，您可以**手動刪除這個有問題的檔案**(_chunk_xxx.srt & raw.txt)，然後對原始影片**重新執行一次轉錄**。程式會跳過已完成的部分，只重新處理這個被您刪除的段落，以節省時間。也可以手動修改有問題的分段字幕檔，然後選擇「僅重新合併 SRT」模式，程式會自動合併分段字幕檔。

   

## 🛠️工具箱(按箭頭會展開介面)  
![imgur](https://imgur.com/5NhmJ64.jpg)  
1.  🎯**局部轉錄**：當發現有部分時間區間沒有轉錄出文字或想重跑，可以只選擇局部時間段轉錄SRT 字幕檔。注意：在temp資料夾會是從00分00秒開始的srt，最終成品要看主程式資料夾裡的`[您的影片名稱]_partial_時間.srt`這個有自動校正時間，可以直接與之前生成的[您的影片名稱].srt`合併。另外，局部轉錄影音長度也請盡量不要超過10分鐘。
**★合併教學-以subtitle edit軟體為例**：上方 工具-合倂字幕，加入完整檔以及局部轉錄檔(在主程式資料夾的，非temp資料夾)，選擇已有正確時間→合併  
![imgur](https://imgur.com/IDUa8pu.jpg)  
2.  ⏱️**SRT時間反查工具**：快速知道某個時間點的原始音訊是來自哪個編號分割檔案的小計算機，預設自動代入下方分割時間段秒數，可手動修改



## 🔑 關於 Google API Key

本工具需要 Google API Key 才能運作。
1.  **如何取得？** 請前往 [Google AI Studio](https://aistudio.google.com/app/apikey) 網站，登入您的 Google 帳號，右上角Create API Key→隨意選擇一個projects→即可建立免費的 API 金鑰→注意須馬上複製key，並且不要隨意告知他人。**Usage&Billing**裡面關注**Request Count per Day**，**注意每日要求數 (RPD)上限**，系統會在太平洋時間午夜重設。
2.  **費用**：Gemini API 提供免費的使用額度，對於一般用量的個人專案通常已經足夠。可觀看官方[頻率限制說明](https://ai.google.dev/gemini-api/docs/rate-limits?hl=zh-tw) ，**gemini-2.5-pro免費方案每日要求數 (RPD)上限為100**。**但是!!**不要每天用到極限，筆者用個幾天高額度就被限制不能用2.5-pro了，得過幾天都不用他才可再用2.5-pro模型  
          ![Imgur](https://imgur.com/yHftrR4.jpg)  



## ❓ 常見問題 (FAQ)

*   **Q: 程式點開閃退？**
    
    *   A: 請務必確認 `AI_TranslateSRT.exe` 和 `ffmpeg.exe` 在同一個資料夾下。其次，您的防毒軟體可能會誤判，請嘗試暫時停用或將本程式加入信任清單。
    
*   **Q: 日誌中出現 `API Key empty response` 錯誤？**
    
    * A: 有幾種可能，一為該區塊剛好沒有對話。二為API Key 暫時被限制，通常這種限制會在幾分鐘到一小時後自動解除，但若過很久重試後仍出現這個提示，且之前能用的話，可能是被google鎖定限制了，有時換一個帳號就能用，但也可能被偵測為同一ip，而一起鎖定。此時只能換比較低一階model，或先不使用幾天避個風頭，又或者嘗試付費的api key。
    
*    **Q: 剛開啟程式時下方參數無法更改？**
   * A: 先點選來源檔案，不論是否有真正選擇，下面參數皆能修改了。

## 額外補充：
1. **侷限**：目前對於幾個場景語音轉SRT效果會比較差，如 唱歌甚至多人唱歌且不同台詞、長時間的無對白(不論是靜音還是純音樂播放)，前者會漏台詞或時間軸時間不精準，後者會有幻覺會隨意亂填入內容，所以建議後者事先將大區塊無對白部分裁切去除(常見於正劇開始前、中場休息時間，還有結束時幕後演員資訊等情況)。如果你不好切除，只能事後手動刪除幻覺部份，若剛好是一整個分割檔都沒有聲音，可以建立同檔名那個區間編號的空srt(至少要寫一條字幕喔，不然0KB是不會跳過的)來卡位，讓ai跳過。
2. **prompt補充**：
   目前對於多義詞，例如英文brother，中文可能為哥哥/弟弟，沒有特別做設計。有需求者可以根據各種語言需要加入到主要規則裡，例如可添加prompt 到{sixth_priority}下方  "對於兄弟姊妹、代名詞、敬語、顏色等多義詞，必須根據上下文推斷，若無法判斷，保留中性詞或加註。 " 然後補充"[角色資料]John: 男, 年長於 Tom; Tom: 男, 年幼於 John;Alice: 女, 無兄弟姐妹資料"J"   
   所有新增請放到{final_instruction} 前面。不過實際上有沒有用我就不清楚了😅
   
      

## 📝 To-Do List

- [ ] **自訂義 URL 以及其 API Key**

- [ ] **英文版介**面
  - [ ] 目前介面會調用指定列表裡繁中字體，都沒有會調用sans-serif。若非中文語系電腦是否會有問題(日誌區域、UI)？
  - [ ] 切換不同語言介面(建立語言檔案?)或者做兩版

  

